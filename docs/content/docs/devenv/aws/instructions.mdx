---
title: Instructions
description: Step-by-step instructions for using the AWS dev environment Makefile
---

Follow these steps to deploy and manage a PostgreSQL HA cluster on AWS using the Makefile.

## 1. Prerequisites
- AWS credentials configured (CLI or environment)
- Go, Terraform, Docker installed
- A Datadog API key and a Datadog application key
- Populate your `.env` variables

## 2. Initialize Terraform Config
```sh
make init-env
```
- Creates `terraform.tfvars` if missing. Edit it with your AWS settings.

## 3. Provision AWS Infrastructure
```sh
make aws
```
- Runs `terraform init`, `plan`, and `apply` to create all AWS resources.

## 4. Generate Deployment Scripts
```sh
make scripts
```
- Generates `config.yaml`, SQL, Docker, and shell scripts from the Terraform state.

## 5. Generate HA Scripts with syncgen
```sh
make syncgen
```
- Builds and runs the main syncgen CLI to generate all HA scripts.

## 6. Deploy PostgreSQL Containers
```sh
make deploy
```
- Deploys PostgreSQL containers and scripts to AWS servers via SSH.

## 7. Transfer and Execute HA Scripts
```sh
make syncgen-transfer-execute
```
- Transfers and runs all generated HA scripts on the VMs, enabling HA.

---

## Convenience Flows
- `make full-deploy`: Runs steps 2â€“6 in one go.
- `make full-stack`: Runs the entire flow, including HA script transfer and execution.
- `make dev-cycle`: Regenerates scripts and redeploys (for rapid iteration).

## Cleaning Up
```sh
make clean
```
- Destroys all infra and removes generated files. **Destructive!**

---

For troubleshooting, see [Troubleshooting](/docs/troubleshooting).
