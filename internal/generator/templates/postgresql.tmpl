# PostgreSQL Streaming Replication Configuration
# Generated by ha-syncgen
# Add these settings to your postgresql.conf

# WAL (Write-Ahead Logging) settings for replication
wal_level = {{ .WalLevel }}
max_wal_senders = {{ .MaxWalSenders }}
wal_keep_size = {{ .WalKeepSize }}

# Archive settings (optional but recommended)
archive_mode = on
archive_command = 'test ! -f /var/lib/postgresql/archive/%f && cp %p /var/lib/postgresql/archive/%f'

# Hot standby settings
hot_standby = {{ .HotStandby }}

# Synchronous replication settings
synchronous_commit = {{ .SynchronousCommit }}

# Enable replication slots (recommended)
max_replication_slots = {{ .MaxReplicationSlots }}

# Connection settings
listen_addresses = '*'
port = {{ .Port }}

# Logging for replication monitoring
log_replication_commands = on
log_min_messages = info
log_line_prefix = '%t [%p]: [%l-1] user=%u,db=%d,app=%a,client=%h '

# Performance tuning for replication
max_connections = 100
shared_buffers = 256MB
effective_cache_size = 1GB
{{- if .HasMonitoring}}
logging_collector = on
log_directory = 'pg_log'  
log_filename = 'pg.log'   
log_statement = 'all'     
#log_duration = on
log_line_prefix= '%m [%p] %d %a %u %h %c '
log_file_mode = 0644
log_min_duration_statement = 0    
log_statement = 'all'
log_duration = on
{{- end }}